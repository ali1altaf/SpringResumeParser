<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Summary</title>
    <style>
        /* Base styles for body and overall layout */
        body {
          font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
          background: linear-gradient(135deg, #f4f7fc, #e6eefc);
          margin: 0;
          padding: 20px;
          display: flex;
          flex-direction: column;
          align-items: center;
          min-height: 100vh;
        }

        /* Main container with a modern card look */
        .container {
          background-color: #ffffff;
          padding: 30px;
          border-radius: 15px;
          box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
          width: 90%;
          max-width: 800px;
          margin-bottom: 20px;
        }

        /* Header styling */
        h1 {
          text-align: center;
          color: #333;
          margin-bottom: 30px;
        }

        /* Flex container for side-by-side details */
        .details-container {
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
        }

        .left-panel, .right-panel {
          background-color: #fafafa;
          border-radius: 10px;
          padding: 20px;
          flex: 1 1 300px;
        }

        .left-panel {
          border: 1px solid #e0e0e0;
        }

        .right-panel {
          border: 1px solid #d0e7ff;
          text-align: center;
        }

        /* Headings within panels */
        .left-panel h3, .right-panel h3 {
          margin-top: 0;
          color: #007bff;
        }

        /* Paragraph text styling */
        p {
          color: #555;
          line-height: 1.6;
          white-space: pre-wrap;
        }

        /* Error message styling */
        .error-message {
          color: #d9534f;
          font-weight: bold;
          text-align: center;
        }

        /* "Parse New File" button styling */
        .parse-new-file-button {
          background-color: #007bff;
          color: white;
          padding: 12px 25px;
          border: none;
          border-radius: 8px;
          font-size: 16px;
          cursor: pointer;
          text-decoration: none;
          transition: background-color 0.3s ease;
        }

        .parse-new-file-button:hover {
          background-color: #0056b3;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>Resume Summary</h1>
    <div class="details-container">
        <div class="left-panel" id="resumeDetails">
            <h3>Skills & Summary</h3>
            <div id="resumeContent">
                <!-- Resume skills and summary will be injected here -->
            </div>
        </div>
        <div class="right-panel">
            <h3>ATS Match Score</h3>
            <p id="atsScore">Loading...</p>
        </div>
    </div>
</div>

<a href="index.html" class="parse-new-file-button">Parse New File</a>

<script>
    const urlParams = new URLSearchParams(window.location.search);
    const fileId = urlParams.get('id');
    const resumeContentDiv = document.getElementById('resumeContent');
    const atsScoreDiv = document.getElementById('atsScore');

    if (!fileId) {
        resumeContentDiv.innerHTML = '<p class="error-message">Error: Invalid or missing file ID.</p>';
        atsScoreDiv.textContent = "N/A";
    } else {
        fetch(`/api/resumes/summary/${fileId}`)
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    resumeContentDiv.innerHTML = `<p class="error-message">Error: ${data.error}</p>`;
                    atsScoreDiv.textContent = "N/A";
                } else {
                    const skillsFormatted = data.skills
                        ? data.skills.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>').replace(/\. /g, '.<br>')
                        : "No skills available.";

                    resumeContentDiv.innerHTML = `
                        <h4>Skills:</h4>
                        <p>${skillsFormatted}</p>
                        <h4>Summary:</h4>
                        <p>${data.summary || "No summary available."}</p>
                    `;
                    atsScoreDiv.textContent = data.ats_score !== undefined ? `${data.ats_score}%` : "No ATS match available.";
                }
            })
            .catch(error => {
                resumeContentDiv.innerHTML = `<p class="error-message">Error fetching resume details: ${error.message}</p>`;
                atsScoreDiv.textContent = "N/A";
            });
    }
</script>

</body>
</html>
